
<link rel="stylesheet" href="{{ url_for('static', path='css/components/header.css') }}">
<script defer src="{{ url_for('static', path='js/components/header.js') }}"></script>
<!-- Alteração Gemini: Adiciona o script do modal de autenticação globalmente -->
<script defer src="{{ url_for('static', path='js/auth-modal.js') }}"></script>
<header>
  <!-- Linha 1: Top Bar -->
  <div class="top-bar">
    <a href="#home" class="top-logo">
      <img src="{{ url_for('static', path='assets/logo/Logo_m.svg') }}" alt="Logo da Loja" style="filter: brightness(0) invert(1);">
    </a>
    <div class="promo-container">
      <div class="promo-message">30% OFF em toda a loja</div>
      <div class="promo-arrow">▼</div>
    </div>

    {# Lógica condicional para o dropdown #}
    {% if user %} 
      <!-- Dropdown para USUÁRIO LOGADO -->
      <div class="user-dropdown">
        <div class="user-info">
          <img src="{{ user.foto_perfil or url_for('static', path='assets/icons/user.png') }}" alt="Foto de Perfil" class="user-photo">
          <div class="user-details">
            <h4>Bem-vindo, {{ user.nome.split(' ')[0] }}!</h4>
            <p>O que vamos fazer hoje?</p>
          </div>
        </div>
        <ul class="user-menu">
          <li><a href="{{ url_for('perfil') }}">Minha Conta</a></li>
          <li><a href="{{ url_for('perfil') }}#cart">Meu Carrinho</a></li>
          <li><a href="{{ url_for('perfil') }}#orders">Meus Pedidos</a></li>
          <li><a href="{{ url_for('perfil') }}#account">Meus Dados</a></li>
          <li><a href="{{ url_for('perfil') }}#favorites">Meus Favoritos</a></li>
          <li><a href="{{ url_for('logout') }}" class="logout-link">Sair</a></li>
        </ul>
      </div>
    {% else %}
      <!-- Dropdown para VISITANTE (Login/Cadastro) -->
      <div class="benefits-dropdown">
        <div class="benefits-content">
            <div class="benefits-main">
            <h3>FAÇA LOGIN</h3>
            <p>Acesse sua conta para uma experiência personalizada</p>
            <div class="benefits-buttons">
              <a href="{{ url_for('login') }}" class="btn-login">Fazer Login</a>
            </div>
          </div>
          <div class="benefits-divider"></div>
            <div class="benefits-secondary">
            <h3>CADASTRE-SE</h3>
            <p>Crie sua conta e aproveite benefícios exclusivos.</p>
            <a href="{{ url_for('cadastro') }}" class="btn-register">Criar Conta</a>
          </div>
        </div>
      </div>
    {% endif %}

    <button class="scroll-to-top" aria-label="Voltar ao topo">↑</button>
  </div>

  <!-- Linha 2: Navegação principal -->
  <nav class="main-nav" aria-label="Menu principal">
    <!-- Logo na esquerda -->
    <a href="{{ url_for('index') }}" class="logo">
      <img src="{{ url_for('static', path='assets/logo/Logo_m.svg') }}" alt="Logo da Loja">
    </a>

  <!-- Links principais centralizados -->
  <ul class="menu-links">
      <li><a href="{{ url_for('catalogo') }}">Destaques</a></li>
      <li><a href="{{ url_for('catalogo') }}">Artigos Esportivos</a></li>
      <li><a href="{{ url_for('catalogo') }}">Homem</a></li>
      <li><a href="{{ url_for('catalogo') }}">Mulher</a></li>
    </ul>

    <!-- Botão hambúrguer para mobile -->
    <button class="hamburger" aria-label="Menu">
      <span></span>
      <span></span>
      <span></span>
    </button>

    <!-- Menu mobile -->
    <div class="mobile-menu">
      <ul>
        <li><a href="{{ url_for('catalogo') }}">Destaques</a></li>
        <li><a href="{{ url_for('catalogo') }}">Artigos Esportivos</a></li>
        <li><a href="{{ url_for('catalogo') }}">Homem</a></li>
        <li><a href="{{ url_for('catalogo') }}">Mulher</a></li>
        <li><a href="#home">Home</a></li>
      </ul>
    </div>

    <!-- Seção direita com elementos reorganizados -->
    <div class="nav-right">
      <!-- Ações do usuário -->
        <div class="user-actions">
          <button class="search-button" aria-label="Buscar">
            <img src="{{ url_for('static', path='assets/icons/magnifying-glass.png') }}" alt="Buscar" class="search-icon">
          </button>
          {# Link do perfil condicional #}
          {% if user %}
            <a href="{{ url_for('perfil') }}" class="profile-link" aria-label="Meu Perfil">
              <img src="{{ url_for('static', path='assets/icons/user.png') }}" alt="Perfil" class="nav-icons profile-icon">
            </a>
            {# Ícone de admin se o usuário for admin #}
            {% if user.is_admin %}
              <a href="{{ url_for('admin') }}" class="admin-link" aria-label="Painel Admin" title="Painel de Administração">
                <img src="{{ url_for('static', path='assets/icons/user.png') }}" alt="Admin" class="nav-icons admin-icon" style="filter: brightness(0.5) saturate(2) hue-rotate(0deg); background-color: rgba(255, 0, 0, 0.3); border-radius: 50%; padding: 4px;">
              </a>
            {% endif %}
          {% else %}
            <a href="{{ url_for('login') }}" class="profile-link" aria-label="Fazer Login">
              <img src="{{ url_for('static', path='assets/icons/user.png') }}" alt="Login" class="nav-icons profile-icon">
            </a>
          {% endif %}
          <a href="{{ url_for('index') }}">
            <img src="{{ url_for('static', path='assets/icons/heart.png') }}" alt="Wishlist" class="nav-icons">
          </a>
          <button id="cart-button" class="cart-button" aria-label="Abrir carrinho">
            <img src="{{ url_for('static', path='assets/icons/carrinho-carrinho.png') }}" alt= "Carrinho" class="nav-icons">
            <span id="cart-count" class="cart-count"></span> <!-- havia um 0 = <span id="cart-count" class="cart-count">0</span>
             removida para teste, condicional relativo a contador de produtos em arrinho icon/modal--> 
          </button>
        </div>
    </div>
  </nav>
</header>

  <!-- Modal de Busca -->
  <div id="search-modal" class="search-modal">
    <div class="search-modal-content">
      <div class="search-modal-header">
        <h3>Buscar Produtos</h3>
        <button class="close-modal" aria-label="Fechar">&times;</button>
      </div>
      <form class="search-modal-form">
        <input type="text" placeholder="Digite o que você está procurando..." class="search-modal-input">
        <button type="submit">Buscar</button>
      </form>
    </div>
  </div>