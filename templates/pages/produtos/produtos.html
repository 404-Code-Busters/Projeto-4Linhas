<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Produtos - 4linhas</title>

  <!-- CSS base (reset, variáveis, estilos globais) -->
  <link rel="stylesheet" href="{{ url_for('static', path='css/base.css') }}">
  <!-- CSS específico da página -->
  <link rel="stylesheet" href="{{ url_for('static', path='css/pages/produtos.css') }}">
  <!-- CSS do header/home para padronizar aparência -->
  <link rel="stylesheet" href="{{ url_for('static', path='css/pages/home.css') }}">
  <!-- CSS inline -->
  <link rel="stylesheet" href="{{ url_for('static', path='css/inline/produtos-inline.css') }}">

  <!-- JS específico da página (loaded at page end to avoid duplicate execution) -->

  <!-- Fonte Google Inter -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap" rel="stylesheet">

  <script src="{{ url_for('static', path='js/cart.js') }}"></script>
  <script src="{{ url_for('static', path='js/pages/home.js') }}"></script>
  <script src="{{ url_for('static', path='js/pages/produtos.js') }}"></script>
  <!-- Ensure cart button opens modal (fallback if cart.js didn't bind) -->

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const cartBtn = document.getElementById('cart-button');
      if (!cartBtn) return;
      cartBtn.addEventListener('click', function(e) {
        e.preventDefault();
        // Prefer the primary implementation from cart.js
        if (typeof mostrarCarrinho === 'function') {
          mostrarCarrinho();
          return;
        }
        if (typeof openCartModal === 'function') {
          openCartModal();
          return;
        }
        // Last-resort: trigger a data-bound anchor if present
        const fake = document.querySelector('a[data-cart]');
        if (fake) fake.click();
      });
    });
  </script>

</head>

<body>

  <!-- =============== HEADER =============== -->
  <header>
  <!-- Linha 1: Top Bar -->
  <div class="top-bar">
    <a href="#home" class="top-logo">
  <img src="{{ url_for('static', path='assets/logo/Logo_m.svg') }}" alt="Logo da Loja" style="filter: brightness(0) invert(1);">
    </a>
    <div class="promo-container">
      <div class="promo-message">30% OFF em toda a loja</div>
      <div class="promo-arrow">▼</div>
    </div>
    <div class="benefits-dropdown">
      <div class="benefits-content">
        <div class="benefits-main">
          <h3>FAÇA LOGIN</h3>
          <p>Acesse sua conta para uma experiência personalizada</p>
          <div class="benefits-buttons">
            <a href="{{ url_for('index') }}" class="btn-login">Fazer Login</a>
          </div>
        </div>
        <div class="benefits-divider"></div>
        <div class="benefits-secondary">
          <h3>CADASTRE-SE</h3>
          <p>Crie sua conta e aproveite benefícios exclusivos:</p>
          <ul class="benefits-list">
            <li>Frete grátis em todas as compras</li>
            <li>Acesso antecipado a produtos exclusivos</li>
            <li>Ofertas especiais para membros</li>
          </ul>
          <div class="benefits-buttons">
            <a href="{{ url_for('index') }}#cadastro" class="btn-register">Criar Conta</a>
          </div>
        </div>
      </div>
    </div>
    <button class="scroll-to-top" aria-label="Voltar ao topo">↑</button>
  </div>

    <!-- Linha 2: Navegação principal -->
    <nav class="main-nav" aria-label="Menu principal">
      <!-- Logo na esquerda -->
      <a href="{{ url_for('index') }}" class="logo">
  <img src="{{ url_for('static', path='assets/logo/Logo_m.svg') }}" alt="Logo da Loja">
      </a>

      <!-- Links principais centralizados -->
      <ul class="menu-links">
        <li><a href="{{ url_for('catalogo') }}">Destaques</a></li>
        <li><a href="{{ url_for('catalogo') }}">Artigos Esportivos</a></li>
        <li><a href="{{ url_for('catalogo') }}">Homem</a></li>
        <li><a href="{{ url_for('catalogo') }}">Mulher</a></li>
      </ul>

      <!-- Botão hambúrguer para mobile -->
      <button class="hamburger" aria-label="Menu">
        <span></span>
        <span></span>
        <span></span>
      </button>

      <!-- Menu mobile -->
      <div class="mobile-menu">
        <ul>
          <li><a href="{{ url_for('catalogo') }}">Destaques</a></li>
          <li><a href="{{ url_for('catalogo') }}">Artigos Esportivos</a></li>
          <li><a href="{{ url_for('catalogo') }}">Homem</a></li>
          <li><a href="{{ url_for('catalogo') }}">Mulher</a></li>
          <li><a href="{{ url_for('catalogo') }}">Produtos</a></li>
          <li><a href="#home">Home</a></li>
          <li><a href="#categoria-principal">Categoria Principal</a></li>
          <li><a href="#competitividade">Competitividade</a></li>
          <li><a href="#sobre">Sobre</a></li>
          <li><a href="#newsletter">Newsletter</a></li>
        </ul>
      </div>

      <!-- Seção direita com elementos reorganizados -->
      <div class="nav-right">
        <!-- Ações do usuário -->
          <div class="user-actions">
            <button class="search-button" aria-label="Buscar">
              <img src="{{ url_for('static', path='assets/icons/magnifying-glass.png') }}" alt="Buscar" class="search-icon">
            </button>
            <a href="{{ url_for('catalogo') }}">
              <img src="{{ url_for('static', path='assets/icons/heart.png') }}" alt="Wishlist" class="nav-icons">
            </a>
            <!-- Replace cart anchor with a button to avoid accidental navigation/hover link -->
            <button id="cart-button" class="cart-button" aria-label="Abrir carrinho">
              <img src="{{ url_for('static', path='assets/icons/carrinho-carrinho.png') }}" alt="Carrinho" class="nav-icons">
              <span id="cart-count" class="cart-count">0</span>
            </button>
          </div>
      </div>
    </nav>
  </header>


  <!-- MAIN CONTENT: PRODUTOS -->
  <main class="products-page">
    <section class="products-hero">
      <h1>Nossos Produtos</h1>
      <p>Explore nossa coleção de produtos de alta qualidade.</p>
    </section>

    <button id="filter-toggle" class="filter-toggle">Filtros</button>
    <section class="filters-section">
      <aside class="filter-sidebar">
        <div class="filter-header">
          <h3>Filtros</h3>
          <button id="close-filters" class="close-filters">&times;</button>
        </div>
        <div class="filter-group">
          <h4>Preço</h4>
          <input type="range" min="0" max="500" value="500" id="price-slider">
          <span id="price-value">Até R$ 500</span>
        </div>
        <div class="filter-group">
          <h4>Cor</h4>
          <div class="color-swatches">
            <div class="swatch active" data-color="black"></div>
            <div class="swatch active" data-color="white"></div>
            <div class="swatch active" data-color="red"></div>
            <div class="swatch active" data-color="blue"></div>
          </div>
        </div>
        <div class="filter-group">
          <h4>Tamanho</h4>
          <label><input type="checkbox" name="size" value="S" checked> S</label>
          <label><input type="checkbox" name="size" value="M" checked> M</label>
          <label><input type="checkbox" name="size" value="L" checked> L</label>
          <label><input type="checkbox" name="size" value="XL" checked> XL</label>
        </div>
      </aside>

      <div class="products-content">
        <div class="top-controls">
          <div class="search-bar">
            <input type="text" placeholder="Buscar produtos..." id="search-input">
            <button id="search-btn">Buscar</button>
          </div>
          <div class="sort-view">
            <select id="sort-select">
              <option value="default">Ordenar por</option>
              <option value="price-low">Preço: Menor para Maior</option>
              <option value="price-high">Preço: Maior para Menor</option>
              <option value="name">Nome</option>
            </select>
            <button id="view-grid" class="view-btn active">Grid</button>
            <button id="view-list" class="view-btn">List</button>
          </div>
        </div>

        <!-- PRODUTOS SECTION -->
        <section class="inspire-section">
        <div class="outfit-grid">
          {% for p in produtos %}
          <div class="outfit-card" data-price="{{ "%.2f"|format(p.preco) }}">
            <a href="{{ url_for('detalhe_produto', id_produto=p.id_produto) }}" class="product-link">
              {# Simple image resolution: use p.imagem_caminho if present, otherwise fallback to placeholder under static/img/ #}
              {% set img_rel = (p.imagem_caminho or '') | trim %}
              {# Strip leading 'static/' if present in DB value so url_for receives a filename relative to static/ #}
              {% if img_rel.startswith('static/') %}
                {% set img_rel = img_rel.replace('static/', '') %}
              {% endif %}
              {% if img_rel == '' %}
                {% set img_rel = 'img/placeholder.png' %}
              {% endif %}
              <img class="product-card-img" src="{{ url_for('static', path=img_rel) }}" alt="{{ p.nome }}">
            </a>
            <div class="outfit-overlay">
              <h3>{{ p.nome }}</h3>
              <p class="product-desc">{{ p.descricao }}</p>
              <p class="product-price">R$ {{ "%.2f"|format(p.preco) }}</p>
              <button class="add-to-cart-btn" data-id="{{ p.id_produto }}">Adicionar ao Carrinho</button>
            </div>
          </div>
          {% endfor %}
        </div>

      </div>
    </section>
  </main>

</footer>

  <!-- FOOTER -->
  <footer class="site-footer">
    <!-- Bloco de Newsletter - Primeiro -->
    <div id="newsletter" class="newsletter">
      <h3>Assine nossa newsletter</h3>
      <p>Receba novidades, promoções e lançamentos em primeira mão.</p>
      <form class="newsletter-form" action="../../newsletter" method="post">
        <input type="email" name="email" placeholder="Seu e-mail" required>
        <button type="submit">Inscrever-se</button>
      </form>
    </div>

    <div class="footer-content">
      <div class="footer-col">
        <a href="/" class="footer-logo">
         <img src="{{ url_for('static', path='assets/logo/Logo_m.svg') }}" alt="Logo da Loja">
        </a>
        <p>Produtos de alta qualidade, estilo e conforto. Inspirados nas melhores marcas do mundo.</p>
      </div>
      <div class="footer-col">
        <h3>Institucional</h3>
        <ul>
          <li><a href="/sobre">Sobre nós</a></li>
          <li><a href="/politica-de-privacidade">Política de Privacidade</a></li>
          <li><a href="/termos">Termos de Uso</a></li>
          <li><a href="/contato">Contato</a></li>
          <li><a href="/carreiras">Carreiras</a></li>
        </ul>
      </div>
      <div class="footer-col">
        <h3>Ajuda</h3>
        <ul>
          <li><a href="/faq">FAQ</a></li>
          <li><a href="/acompanhe-pedido">Acompanhe seu pedido</a></li>
          <li><a href="/suporte">Suporte</a></li>
          <li><a href="/trocas">Trocas e Devoluções</a></li>
          <li><a href="/entrega">Entrega</a></li>
        </ul>
      </div>
      <div class="footer-col">
        <h3>Nos siga</h3>
        <div class="footer-social">
          <a href="#"><img src="{{ url_for('static', path='assets/icons/instagram.svg') }}" alt="Instagram"></a>
          <a href="#"><img src="{{ url_for('static', path='assets/icons/facebook.svg') }}" alt="Facebook"></a>
          <!-- Twitter removed per request -->
        </div>
      </div>
      <div class="footer-col">
        <h3>Produtos</h3>
        <ul>
          <li><a href="/homem">Homem</a></li>
          <li><a href="/mulher">Mulher</a></li>
          <li><a href="/artigos">Artigos</a></li>
          <li><a href="/destaques">Destaques</a></li>
        </ul>
      </div>
    </div>

    <div class="footer-bottom">
      <p>&copy; 2025 4linhas. Todos os direitos reservados. | CNPJ: 12.345.678/0001-90</p>
    </div>
  </footer>

</body>
</html>
