<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" href="{{ url_for('static', path='assets/favicon/favicon-4linhas.svg') }}" type="image/x-icon">

  <title>Catálogo - 4linhas</title>

  <!-- CSS base (reset, variáveis, estilos globais) -->
  <link rel="stylesheet" href="{{ url_for('static', path='css/base.css') }}">
  <!-- Header component styles -->
  <link rel="stylesheet" href="{{ url_for('static', path='css/components/header.css') }}">
  <!-- Alteração Gemini: Adiciona o CSS para o modal de autenticação -->
  <link rel="stylesheet" href="{{ url_for('static', path='css/components/auth-modal.css') }}">
  <!-- CSS especifico da página -->
  <link rel="stylesheet" href="{{ url_for('static', path='css/pages/produtos.css') }}">

  <!-- Fonte Google Inter -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap" rel="stylesheet">

  <style>
    /* Alteração feita pelo Gemini: Estilos da versão antiga dos cards foram movidos para produtos.css */
    /* Mantivemos aqui apenas os estilos essenciais para o formulário de filtros e a estrutura da página. */
    .catalogo-page {
      max-width: 1200px;
      margin: 0 auto;
      padding: 2rem;
    }
    .filtros-catalogo {
      background-color: #f9f9f9;
      padding: 26px; /* maior padding para melhor espaçamento */
      border-radius: 10px;
      margin-bottom: 28px;
      border: 1px solid #eee;
    }
    #form-filtros {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      align-items: end;
    }
    .filtro-grupo {
      display: flex;
      flex-direction: column;
    }
    .filtro-grupo label {
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 8px;
      color: #333;
    }
    .filtro-grupo input,
    .filtro-grupo select {
      width: 100%;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 4px;
      font-size: 14px;
    }
    .filtro-acoes {
      display: flex;
      gap: 10px;
      align-items: center;
    }
    .btn-filtrar, .btn-limpar {
      padding: 0.65rem 1.5rem;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 600;
      text-decoration: none;
      text-align: center;
      font-size: 0.95rem;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
      height: 40px;
      white-space: nowrap;
      transition: all 0.2s ease;
    }
    .btn-filtrar {
      background-color: var(--cor-laranja, #FF6B35);
      color: white;
    }
    .btn-filtrar:hover {
      background-color: #e05b2d;
      transform: translateY(-2px);
    }
    .btn-limpar {
      background-color: #6c757d;
      color: white;
    }
    .btn-limpar:hover {
      background-color: #5a6268;
      transform: translateY(-2px);
    }
    /* Simple type filter button styles */
    .tipo-btn {
      background: transparent;
      border: 1px solid #e0e0e0;
      padding: 8px 12px;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 600;
      color: #333;
    }
    .tipo-btn:hover { background: #f3f3f3; }
    .tipo-btn.active-tipo { background: var(--cor-laranja, #FF6B35); color: #fff; border-color: var(--cor-laranja, #FF6B35); }
    /* Estilos para a grade de produtos e cards foram movidos para produtos.css */
  </style>
</head>
<body>

  {% include 'partials/header.html' %}

  <main class="catalogo-page">
    <h1>Nosso Catálogo</h1>
    <p>Encontre os melhores produtos para o seu estilo.</p>

    <!-- Alteração feita pelo Gemini: Formulário de filtros para a página de catálogo. -->
    <!-- Este formulário permite que os usuários busquem e filtrem produtos por nome, tamanho, cor e preço máximo. -->
    <!-- Os valores dos campos são preenchidos dinamicamente com base nos parâmetros da URL para manter o estado dos filtros. -->
    <section class="filtros-catalogo">
      <!-- Filtro simplificado: apenas busca por nome -->
      <form id="form-filtros" action="{{ url_for('catalogo') }}" method="GET">
        <div style="display: flex; flex-direction: column; gap: 12px;">
          <div>
            <label for="q" style="display: block; font-size: 14px; font-weight: 600; margin-bottom: 8px; color: #333;">Buscar por nome</label>
            <input type="search" id="q" name="q" placeholder="Ex: Camisa Polo" value="{{ request.query_params.get('q', '') }}" style="width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 4px; font-size: 14px;">
          </div>

          <div style="display: flex; gap: 8px;">
            <button type="submit" class="btn-filtrar">Buscar</button>
            <a href="{{ url_for('catalogo') }}" class="btn-limpar">Limpar</a>
          </div>
        </div>
      </form>
    </section>

    <!-- Alteração feita pelo Gemini: Seção de produtos atualizada para usar o layout de card antigo (outfit-card). -->
    <!-- O loop agora percorre os 'produtos' filtrados pelo backend e os renderiza com o visual que você preferia. -->
    <!-- Se nenhum produto for encontrado, exibe uma mensagem. -->
    <section class="inspire-section">
      <div class="outfit-grid">
      {% if produtos %}
        {% for produto in produtos %}
          <div class="outfit-card" data-price="{{ "%.2f"|format(produto.preco) }}">
            <a href="{{ url_for('detalhe_produto', id_produto=produto.id_produto) }}" class="product-link">
              <img class="product-card-img" 
                   src="{{ url_for('static', path='upload/img/' + produto.imagem_caminho) if produto.imagem_caminho else url_for('static', path='assets/logo/4linhas-bg-red.svg') }}" 
                   alt="{{ produto.nome }}">
            </a>
            <!-- <div class="favorite-button {% if produto.id_produto in favoritos_ids %}favorited{% endif %}" data-product-id="{{ produto.id_produto }}">
                <img src="{{ url_for('static', path='assets/icons/') }}{% if produto.id_produto in favoritos_ids %}add-to-favorites.png{% else %}heart.png{% endif %}" alt="Favoritar">
            </div> -->
            <div class="outfit-overlay">
              <h3><a href="{{ url_for('detalhe_produto', id_produto=produto.id_produto) }}" class="product-title-link">{{ produto.nome }}</a></h3>
              <a href="{{ url_for('detalhe_produto', id_produto=produto.id_produto) }}" class="product-desc-link"><p class="product-desc">{{ produto.descricao }}</p></a>
              <p class="product-price">R$ {{ "%.2f"|format(produto.preco)|replace('.', ',') }}</p>
              <p class="product-size">Tamanho: {{ produto.tamanho }}</p>
              <button class="add-to-cart-btn" data-product-id="{{ produto.id_produto }}"
                      {% if produto.estoque <= 0 %}disabled{% endif %}>
                {% if produto.estoque > 0 %}Adicionar ao Carrinho{% else %}Fora de Estoque{% endif %}
              </button>
            </div>
          </div>
        {% endfor %}
      {% else %}
        <p>Nenhum produto encontrado com os filtros selecionados.</p>
      {% endif %}
      </div>
    </section>
  </main>
  
  {% include 'partials/footer.html' %}

  <!-- Scripts -->
  <script src="{{ url_for('static', path='js/auth-modal.js') }}" defer></script>
  <script src="{{ url_for('static', path='js/cart.js') }}" defer></script>
  <script src="{{ url_for('static', path='js/favoritos.js') }}" defer></script>



</body>
</html>