<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Perfil - 4linhas</title>

  <!-- CSS base (reset, variáveis, estilos globais) -->
  <link rel="stylesheet" href="{{ url_for('static', path='css/base.css') }}">
  <!-- CSS especifico da página -->
  <link rel="stylesheet" href="{{ url_for('static', path='css/pages/carrinho.css') }}">
  <!-- CSS perfil/abas -->
  <link rel="stylesheet" href="{{ url_for('static', path='css/pages/perfil.css') }}">
  <!-- CSS inline extraído -->
  <link rel="stylesheet" href="{{ url_for('static', path='css/inline/carrinho-inline.css') }}">
  
  <script src="{{ url_for('static', path='js/cart.js') }}"></script>

  <!-- Fonte Google Inter -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap" rel="stylesheet">
</head>
<body>

  <!-- =============== HEADER =============== -->
  <header>
  <!-- Linha 1: Top Bar -->
  <div class="top-bar">
    <a href="#home" class="top-logo">
  <img src="{{ url_for('static', path='assets/logo/Logo_m.svg') }}" alt="Logo da Loja">
    </a>
    <div class="promo-container">
      <div class="promo-message">30% OFF em toda a loja</div>
      <div class="promo-arrow">▼</div>
    </div>
    <div class="benefits-dropdown">
      <div class="benefits-content">
        <div class="benefits-main">
          <h3>FAÇA LOGIN</h3>
          <p>Acesse sua conta para uma experiência personalizada</p>
          <div class="benefits-buttons">
            <a href="{{ url_for('index') }}" class="btn-login">Fazer Login</a>
          </div>
        </div>
        <div class="benefits-divider"></div>
        <div class="benefits-secondary">
          <h3>CADASTRE-SE</h3>
          <p>Crie sua conta e aproveite benefícios exclusivos:</p>
          <ul class="benefits-list">
            <li>Frete grátis em todas as compras</li>
            <li>Acesso antecipado a produtos exclusivos</li>
            <li>Ofertas especiais para membros</li>
          </ul>
          <div class="benefits-buttons">
            <a href="{{ url_for('index') }}#cadastro" class="btn-register">Criar Conta</a>
          </div>
        </div>
      </div>
    </div>
    <button class="scroll-to-top" aria-label="Voltar ao topo">↑</button>
  </div>

    <!-- Linha 2: Navegação principal -->
    <nav class="main-nav" aria-label="Menu principal">
      <!-- Logo na esquerda -->
    <a href="{{ url_for('index') }}" class="logo">
  <img src="{{ url_for('static', path='assets/logo/Logo_m.svg') }}" alt="Logo da Loja">
    </a>

      <!-- Links principais centralizados -->
      <ul class="menu-links">
  <li><a href="{{ url_for('catalogo') }}">Destaques</a></li>
  <li><a href="{{ url_for('catalogo') }}">Artigos Esportivos</a></li>
  <li><a href="{{ url_for('catalogo') }}">Homem</a></li>
  <li><a href="{{ url_for('catalogo') }}">Mulher</a></li>
      </ul>

      <!-- Botão hambúrguer para mobile -->
      <button class="hamburger" aria-label="Menu">
        <span></span>
        <span></span>
        <span></span>
      </button>

      <!-- Menu mobile -->
      <div class="mobile-menu">
        <ul>
          <li><a href="{{ url_for('catalogo') }}">Destaques</a></li>
          <li><a href="{{ url_for('catalogo') }}">Artigos Esportivos</a></li>
          <li><a href="{{ url_for('catalogo') }}">Homem</a></li>
          <li><a href="{{ url_for('catalogo') }}">Mulher</a></li>
          <li><a href="{{ url_for('catalogo') }}">Produtos</a></li>
          <li><a href="#home">Home</a></li>
          <li><a href="#categoria-principal">Categoria Principal</a></li>
          <li><a href="#competitividade">Competitividade</a></li>
          <li><a href="#sobre">Sobre</a></li>
          <li><a href="#newsletter">Newsletter</a></li>
        </ul>
      </div>

      <!-- Seção direita com elementos reorganizados -->
      <div class="nav-right">
        <!-- Ações do usuário -->
          <div class="user-actions">
            <button class="search-button" aria-label="Buscar">
              <img src="{{ url_for('static', path='assets/icons/magnifying-glass.png') }}" alt="Buscar" class="search-icon">
            </button>
            <a href="{{ url_for('perfil') }}" class="profile-link" aria-label="Perfil">
              <img src="{{ url_for('static', path='assets/icons/user.png') }}" alt="Perfil" class="nav-icons profile-icon">
            </a>
            <a href="{{ url_for('index') }}">
              <img src="{{ url_for('static', path='assets/icons/heart.png') }}" alt="Wishlist" class="nav-icons">
            </a>
            <button id="cart-button" class="cart-button" aria-label="Abrir carrinho">
              <img src="{{ url_for('static', path='assets/icons/carrinho-carrinho.png') }}" alt= "Carrinho" class="nav-icons">
              <span id="cart-count" class="cart-count">0</span>
            </button>
          </div>
      </div>
    </nav>
  </header>

  <!-- MAIN CONTENT: PERFIL DE USUÁRIO (Abas: Carrinho, Pedidos, Conta) -->
  <main class="profile-page">
    <section class="profile-hero">
      <h1>Minha Conta</h1>
      <p>Visão geral da sua conta e pedidos.</p>
    </section>

    <!-- Abas principais -->
    <div class="profile-tabs" role="tablist" aria-label="Seções da conta">
      <button class="tab-btn active" data-tab="cart" role="tab" aria-selected="true">Carrinho</button>
      <button class="tab-btn" data-tab="orders" role="tab" aria-selected="false">Pedidos</button>
      <button class="tab-btn" data-tab="account" role="tab" aria-selected="false">Conta</button>
    </div>

    <!-- Conteúdo das abas -->
    <section class="tab-contents">
      <!-- Aba CARRINHO: mantive todo o conteúdo existente do carrinho aqui -->
      <div id="tab-cart" class="tab-content active" role="tabpanel">
        <section class="cart-hero">
          <h2>Seu Carrinho</h2>
          <p>Revise os itens antes de finalizar a compra.</p>
        </section>

        <section class="cart-content">
          <div class="cart-items">
            {% if carrinho %}
              <table style="width: 100%; border-collapse: collapse;">
                <thead>
                  <tr>
                    <th style="text-align: left; padding: 10px; border-bottom: 1px solid #ddd;">Produto</th>
                    <th style="text-align: right; padding: 10px; border-bottom: 1px solid #ddd;">Preço</th>
                    <th style="text-align: right; padding: 10px; border-bottom: 1px solid #ddd;">Quantidade</th>
                    <th style="text-align: right; padding: 10px; border-bottom: 1px solid #ddd;">Total</th>
                  </tr>
                </thead>
                <tbody>
                  {% for item in carrinho %}
                  <tr>
                    <td style="text-align: left; padding: 10px; border-bottom: 1px solid #eee;">{{ item.nome }}</td>
                    <td style="text-align: right; padding: 10px; border-bottom: 1px solid #eee;">R$ {{ "%.2f"|format(item.preco) }}</td>
                    <td style="text-align: right; padding: 10px; border-bottom: 1px solid #eee;">{{ item.quantidade }}</td>
                    <td style="text-align: right; padding: 10px; border-bottom: 1px solid #eee;">R$ {{ "%.2f"|format(item.preco * item.quantidade) }}</td>
                  </tr>
                  {% endfor %}
                  <tr>
                    <td colspan="3" style="text-align: right; padding: 10px; font-weight: bold;">Total:</td>
                    <td style="text-align: right; padding: 10px; font-weight: bold;">R$ {{ "%.2f"|format(total) }}</td>
                  </tr>
                </tbody>
              </table>
            {% else %}
              <div class="empty-cart" style="text-align: center; padding: 20px;">
                <p>Seu carrinho está vazio</p>
                <a href="{{ url_for('catalogo') }}" style="display: inline-block; margin-top: 10px; padding: 10px 20px; background-color: #FF6B35; color: white; text-decoration: none; border-radius: 4px;">Ver produtos</a>
              </div>
            {% endif %}
          </div>

          <div class="cart-summary">
            <h2>Resumo do Pedido</h2>
            <div class="promo-code-section">
              <label for="promo-code">Código Promocional</label>
              <input type="text" id="promo-code" name="promo-code" placeholder="Insira seu código">
              <button class="apply-promo-btn">Aplicar</button>
            </div>
            <div class="summary-row">
              <span>Subtotal:</span>
              <span>R$ {{ "%.2f"|format(total) }}</span>
            </div>
            <div class="summary-row">
              <span>Frete:</span>
              <span>R$ {{ "%.2f"|format(20.00) }}</span>
            </div>
            <div class="summary-row total">
              <span>Total:</span>
              <span>R$ {{ "%.2f"|format(total + 20.00) }}</span>
            </div>
            <form action="{{ url_for('checkout') }}" method="post">
              <button type="submit" class="checkout-btn">Finalizar Compra</button>
            </form>
          </div>
        </section>

        <!-- Recomendações mantidas dentro da aba Carrinho -->
        <section class="recommendations">
          <h2>Recomendações para Você</h2>
          <div class="recommendations-grid">
            <div class="recommendation-item">
              <img src="{{ url_for('static', path='assets/images/home/banners/Carrossel/austrian-national-library-h39HBKBclNM-unsplash.jpg') }}" alt="Produto Recomendado 1">
              <h3>Produto Recomendado 1</h3>
              <p>R$ 149,90</p>
              <button class="add-to-cart-btn">Adicionar ao Carrinho</button>
            </div>
            <div class="recommendation-item">
              <img src="{{ url_for('static', path='assets/images/home/banners/Carrossel/gentrit-sylejmani-JjUyjE-oEbM-unsplash.jpg') }}" alt="Produto Recomendado 2">
              <h3>Produto Recomendado 2</h3>
              <p>R$ 249,90</p>
              <button class="add-to-cart-btn">Adicionar ao Carrinho</button>
            </div>
            <div class="recommendation-item">
              <img src="{{ url_for('static', path='assets/images/home/banners/Carrossel/austrian-national-library-h39HBKBclNM-unsplash.jpg') }}" alt="Produto Recomendado 3">
              <h3>Produto Recomendado 3</h3>
              <p>R$ 199,90</p>
              <button class="add-to-cart-btn">Adicionar ao Carrinho</button>
            </div>
            <div class="recommendation-item">
              <img src="{{ url_for('static', path='assets/images/home/banners/Carrossel/gentrit-sylejmani-JjUyjE-oEbM-unsplash.jpg') }}" alt="Produto Recomendado 4">
              <h3>Produto Recomendado 4</h3>
              <p>R$ 299,90</p>
              <button class="add-to-cart-btn">Adicionar ao Carrinho</button>
            </div>
          </div>
        </section>
      </div>

      <!-- Aba PEDIDOS: placeholder inicial -->
      <div id="tab-orders" class="tab-content" role="tabpanel" hidden>
        <section class="orders-section">
          <h2>Seus Pedidos</h2>
          <p>Aqui serão listados seus pedidos anteriores. (Placeholder)</p>
          <div class="orders-list">
            <p>Nenhum pedido encontrado.</p>
          </div>
        </section>
      </div>

      <!-- Aba CONTA: informações do usuário e configurações -->
      <div id="tab-account" class="tab-content" role="tabpanel" hidden>
        <section class="account-section">
          <h2>Informações da Conta</h2>
          <form action="{{ url_for('atualizar_senha') }}" method="post">
            <p>Nome: <strong>{{ cliente.nome if cliente is defined else 'Usuário' }}</strong></p>
            <p>Email: <strong>{{ cliente.email if cliente is defined else 'email@exemplo.com' }}</strong></p>
            <div class="password-update">
              <label for="nova_senha">Nova senha</label>
              <input type="password" id="nova_senha" name="nova_senha" placeholder="Digite a nova senha">
              <button type="submit" class="btn">Atualizar senha</button>
            </div>
          </form>
          <a href="{{ url_for('logout') }}" class="btn-logout">Sair</a>
          <h3>Endereços</h3>
          <p>Gerencie seus endereços de entrega aqui. (Placeholder)</p>
        </section>
      </div>
    </section>
  </main>

  <!-- Modal de Busca -->
  <div id="search-modal" class="search-modal">
    <div class="search-modal-content">
      <div class="search-modal-header">
        <h3>Buscar Produtos</h3>
        <button class="close-modal" aria-label="Fechar">&times;</button>
      </div>
      <form class="search-modal-form">
        <input type="text" placeholder="Digite o que você está procurando..." class="search-modal-input">
        <button type="submit">Buscar</button>
      </form>
    </div>
  </div>

  <!-- FOOTER -->
  <footer class="site-footer">
    <!-- Bloco de Newsletter - Primeiro -->
    <div class="newsletter">
      <h3>Assine nossa newsletter</h3>
      <p>Receba novidades, promoções e lançamentos em primeira mão.</p>
      <form class="newsletter-form" action="/newsletter" method="post">
        <input type="email" name="email" placeholder="Seu e-mail" required>
        <button type="submit">Inscrever-se</button>
      </form>
    </div>

    <div class="footer-content">
      <div class="footer-col">
        <a href="/" class="footer-logo">
          <img src="{{ url_for('static', path='assets/logo/Logo_m.svg') }}" alt="Logo da Loja">
        </a>
        <p>Produtos de alta qualidade, estilo e conforto. Inspirados nas melhores marcas do mundo.</p>
      </div>
      <div class="footer-col">
        <h3>Institucional</h3>
        <ul>
          <li><a href="/sobre">Sobre nós</a></li>
          <li><a href="/politica-de-privacidade">Política de Privacidade</a></li>
          <li><a href="/termos">Termos de Uso</a></li>
          <li><a href="/contato">Contato</a></li>
          <li><a href="/carreiras">Carreiras</a></li>
        </ul>
      </div>
      <div class="footer-col">
        <h3>Ajuda</h3>
        <ul>
          <li><a href="/faq">FAQ</a></li>
          <li><a href="/acompanhe-pedido">Acompanhe seu pedido</a></li>
          <li><a href="/suporte">Suporte</a></li>
          <li><a href="/trocas">Trocas e Devoluções</a></li>
          <li><a href="/entrega">Entrega</a></li>
        </ul>
      </div>
      <div class="footer-col">
        <h3>Nos siga</h3>
        <div class="footer-social">
          <a href="#"><img src="{{ url_for('static', path='assets/icons/instagram.svg') }}" alt="Instagram"></a>
          <a href="#"><img src="{{ url_for('static', path='assets/icons/facebook.svg') }}" alt="Facebook"></a>
          <!-- Twitter removed per request -->
        </div>
      </div>
      <div class="footer-col">
        <h3>Produtos</h3>
        <ul>
          <li><a href="/homem">Homem</a></li>
          <li><a href="/mulher">Mulher</a></li>
          <li><a href="/artigos">Artigos</a></li>
          <li><a href="/destaques">Destaques</a></li>
        </ul>
      </div>
    </div>

    <div class="footer-bottom">
      <p>&copy; 2025 4linhas. Todos os direitos reservados. | CNPJ: 12.345.678/0001-90</p>
    </div>
  </footer>

  <!-- Script para alternância de abas da página de perfil -->
  <script>
    (function() {
      // Seleciona botões e conteúdos das abas
      const tabButtons = Array.from(document.querySelectorAll('.tab-btn'));
      const tabContents = Array.from(document.querySelectorAll('.tab-content'));

      // Função que ativa a aba pelo nome (data-tab)
      function activateTab(tabName, setFocus = false) {
        tabButtons.forEach(btn => {
          const isActive = btn.getAttribute('data-tab') === tabName;
          btn.classList.toggle('active', isActive);
          btn.setAttribute('aria-selected', isActive ? 'true' : 'false');
          btn.setAttribute('tabindex', isActive ? '0' : '-1');
        });

        tabContents.forEach(content => {
          const shouldShow = content.id === `tab-${tabName}`;
          if (shouldShow) {
            content.classList.add('active');
            content.removeAttribute('hidden');
          } else {
            content.classList.remove('active');
            content.setAttribute('hidden', '');
          }
        });

        if (setFocus) {
          const activeBtn = tabButtons.find(b => b.getAttribute('data-tab') === tabName);
          if (activeBtn) activeBtn.focus();
        }
      }

      // Adiciona listeners aos botões
      tabButtons.forEach(btn => {
        btn.addEventListener('click', () => {
          const tabName = btn.getAttribute('data-tab');
          activateTab(tabName, true);
        });

        btn.addEventListener('keydown', (e) => {
          const index = tabButtons.indexOf(document.activeElement);
          if (e.key === 'ArrowRight' || e.key === 'ArrowDown') {
            e.preventDefault();
            const next = tabButtons[(index + 1) % tabButtons.length];
            next.focus();
          } else if (e.key === 'ArrowLeft' || e.key === 'ArrowUp') {
            e.preventDefault();
            const prev = tabButtons[(index - 1 + tabButtons.length) % tabButtons.length];
            prev.focus();
          } else if (e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            const tabName = btn.getAttribute('data-tab');
            activateTab(tabName, true);
          }
        });
      });

      // Inicializa uma aba ativa por padrão (a que tiver a classe .active ou a primeira)
      (function init() {
        const activeBtn = tabButtons.find(b => b.classList.contains('active')) || tabButtons[0];
        const activeTab = activeBtn ? activeBtn.getAttribute('data-tab') : null;
        tabButtons.forEach(b => b.setAttribute('tabindex', b === activeBtn ? '0' : '-1'));
        if (activeTab) activateTab(activeTab, false);
      })();
    })();
  </script>

</body>
</html>

