<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" href="{{ url_for('static', path='assets/favicon/favicon-4linhas.ico') }}" type="image/x-icon">
  <title>Produto - 4linhas</title>

  <!-- CSS do Swiper (if needed for any sliders) -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.css">

  <!-- CSS base (reset, variáveis, estilos globais) -->
  <link rel="stylesheet" href="{{ url_for('static', path='css/base.css') }}">
  <!-- CSS específico do produto -->
  <link rel="stylesheet" href="{{ url_for('static', path='css/pages/produto.css') }}">
  <!-- inline styles migrated to components/header.css -->

  <!-- Fonte Google Inter -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap" rel="stylesheet">

  <!-- JS da página de produto -->
  <script src="{{ url_for('static', path='js/pages/produto.js') }}" defer></script>

</head>
<body>
</head>
<body>

  {% include 'partials/header.html' %}

  <!-- Produto Principal -->
  <main class="product-main">
    <div class="product-gallery">
      {# Define a imagem principal. Usa a primeira imagem disponível. #}
      {% set main_image_path = produto.imagem_caminho or produto.imagem_caminho1 or produto.imagem_caminho2 or produto.imagem_caminho3 or 'assets/logo/4linhas-bg-red.svg' %}
      <img src="{{ url_for('static', path='/upload/img/' + main_image_path) }}" alt="{{ produto.nome }}" class="product-image-main" id="main-product-image">

      {# Gera a lista de todas as imagens disponíveis para as miniaturas #}
      {% set image_paths = [
        produto.imagem_caminho,
        produto.imagem_caminho1,
        produto.imagem_caminho2,
        produto.imagem_caminho3
      ] %}

      <div class="product-thumbnails">
      {% for img_path in image_paths %}
        {% if img_path %}
          <img src="{{ url_for('static', path='/upload/img/' + img_path) }}" 
               alt="Miniatura de {{ produto.nome }}" 
               class="thumbnail {% if loop.first %}active{% endif %}"
               data-full-image="{{ url_for('static', path='/upload/img/' + img_path) }}">
        {% endif %}
      {% endfor %}
      </div>
    </div>

    <div class="product-info">
      <h1 class="product-title">{{ produto.nome }}</h1>
      <div class="product-rating">
        <span class="stars">★★★★★</span>
        <span>(12 avaliações)</span>
      </div>
      <div class="product-price">R$ {{ "%.2f"|format(produto.preco)|replace('.', ',') }}</div>
      <p class="product-description">{{ produto.descricao }}</p>

      <div class="product-options" data-product-name="{{ produto.nome.lower() }}" data-product-type="auto" data-tamanho="{{ produto.tamanho }}">
        <div class="option-group">
          <label class="option-label">Tamanho:</label>
          <select class="option-select" id="tamanho-select">
            <option value="">Selecione um tamanho</option>
            <!-- Opções serão preenchidas pelo JavaScript baseado no tamanho do banco -->
          </select>
        </div>
        <div class="option-group">
          <label class="option-label">Cor:</label>
          <select class="option-select">
            <option>Preto</option>
            <option>Azul</option>
            <option>Vermelho</option>
          </select>
        </div>
      </div>

      <div class="product-actions">
        <button class="btn-primary add-to-cart" data-product-id="{{ produto.id_produto }}">Adicionar ao Carrinho</button>
        <!-- >button class="btn-secondary favorite-button {% if is_favorited %}favorited{% endif %}" data-product-id="{{ produto.id_produto }}">
            <img src="{{ url_for('static', path='assets/icons/') }}{% if is_favorited %}add-to-favorites.png{% else %}heart.png{% endif %}" alt="Favoritar Produto">
            Favoritar
        </button> -->
      </div> 

      <div class="product-specs">
        <h3 class="specs-title">Especificações</h3>
        <div class="specs-grid">
          <div class="spec-item">
            <div class="spec-label">Material:</div>
            <div class="spec-value">Poliéster 95%, Elastano 5%</div>
          </div>
          <div class="spec-item">
            <div class="spec-label">Tamanho:</div>
            <div class="spec-value">{{ produto.tamanho }}</div>
          </div>
          <div class="spec-item">
            <div class="spec-label">Cor:</div>
            <div class="spec-value">{{ produto.cor }}</div>
          </div>
          <div class="spec-item">
            <div class="spec-label">Frete:</div>
            <div class="spec-value">Grátis acima de R$100</div>
          </div>
        </div>
      </div>
    </div>
  </main>

  <!-- Produtos Relacionados -->
  <section class="related-products">
    <h2 class="related-title">Produtos Relacionados</h2>
    <div class="related-grid">
      {% if related_produtos %}
        {% for rel in related_produtos %}
          <a href="{{ url_for('detalhe_produto', id_produto=rel.id_produto) }}" class="related-card">
            {% set rel_img = rel.imagem_caminho or rel.imagem_caminho1 or rel.imagem_caminho2 or rel.imagem_caminho3 %}
            <img src="{{ url_for('static', path='upload/img/' + rel_img) if rel_img else url_for('static', path='assets/logo/4linhas-bg-red.svg') }}" alt="{{ rel.nome }}" class="related-image">
            <div class="related-info">
              <h3 class="related-card-title">{{ rel.nome }}</h3>
              <div class="related-price">R$ {{ "%.2f"|format(rel.preco)|replace('.', ',') }}</div>
            </div>
          </a>
        {% endfor %}
      {% else %}
        <p>Não há produtos relacionados no momento.</p>
      {% endif %}
    </div>
  </section>

  <!-- Modal de Busca -->
  <div id="search-modal" class="search-modal">
    <div class="search-modal-content">
      <div class="search-modal-header">
        <h3>Buscar Produtos</h3>
        <button class="close-modal" aria-label="Fechar">&times;</button>
      </div>
      <form class="search-modal-form">
        <input type="text" placeholder="Digite o que você está procurando..." class="search-modal-input">
        <button type="submit">Buscar</button>
      </form>
    </div>
  </div>
    {% include 'partials/footer.html' %}


  <!-- JS do Swiper (already included in head) -->
  <script src="{{ url_for('static', path='js/cart.js') }}"></script>
  <script src="{{ url_for('static', path='js/favoritos.js') }}"></script>
</body>
</html>
